---
title: "HotSpotMap"
author: "Pete Way"
date: "2/13/2019"
output: pdf_document
---

```{r}
library(maps)
# utc=read.csv("/Users/pete/Documents/GitHub/SCAL_USIgnite-911/Excel & CSV Sheets/Full Data.csv", header=T)
# #head(utc)
# 
# a=which(utc$Accident==1)
# df=utc[a,]#look at only the accident records
# 
# locations=data.frame(df$Route, df$Longitude, df$Latitude)
# u=unique(locations)
# 
# sums=rep(0, dim(u)[1])#'sums' will be the # of accidents at each unique loc.
# for (i in 1:dim(u)[1]){
# w=which(df$Route==u[i,1] & df$Longitude==u[i,2] &
# 	df$Latitude==u[i,3])
# sums[i]<-length(df$Accident[w])
# }

df4=data.frame(u, sums)#uniques locations and the number of accidents there

rank=rep(NA, dim(df4)[1])
rank[which(sums<=50 & sums>25)]<-'yellow'
rank[which(sums<=75 & sums>50)]<-'orange'
rank[which(sums<=100 & sums>75)]<-'red'
rank[which(sums>100)]<-'black'
#I chose these thresholds arbitrarily.  Feel free to change

locs=data.frame(u[,2:3])
par(mar = rep(0, 4))
# windows()
png("../Graphs & Images/R Maps/HamiltonHotSpotsEricCode.png", width=12,height=12,units='in', res=300)
map('county','tennessee,hamilton',lwd=1, fill=T, col='darkgrey')
# title(main='Hamilton County, Tennessee', )


w=which(rank=='yellow')
points(locs[w,], pch=16, cex=1, col=rank[w])

w=which(rank=='orange')
points(locs[w,], pch=16, cex=1.5, col=rank[w])

w=which(rank=='red')
points(locs[w,], pch=16, cex=2, col=rank[w])

w=which(rank=='black')
points(locs[w,], pch=16, cex=3, col=rank[w])

legend("topleft",c( '(25,50]', '(50,75]','(75,100]', '>100'), pch = 16, 
	pt.cex=c(1,2,3,4), cex = 3, 
	       	col = c( 'yellow','orange', 'red', 'black'),
		title='# of Accidents', box.col='black', bg='grey')
dev.off()
```


